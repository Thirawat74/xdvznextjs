module.exports=[70988,a=>{"use strict";var b=a.i(87924),c=a.i(56025),d=a.i(50944),e=a.i(72131),f=a.i(68684);function g({children:a}){let{isAuth:g,loading:h}=(0,c.useAuth)(),i=(0,d.useRouter)();return((0,e.useEffect)(()=>{h||g||i.push("/")},[g,h,i]),h)?(0,b.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,b.jsx)(f.Spinner,{})}):g?(0,b.jsx)(b.Fragment,{children:a}):null}a.s(["default",()=>g])},30748,73570,a=>{"use strict";var b=a.i(39355);a.s(["UserIcon",()=>b.default],30748);var c=a.i(83604);a.s(["AlertTriangle",()=>c.default],73570)},24348,14548,a=>{"use strict";var b=a.i(87924),c=a.i(187),d=a.i(68114);let e=(0,c.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function f({className:a,variant:c,...f}){return(0,b.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,d.cn)(e({variant:c}),a),...f})}function g({className:a,...c}){return(0,b.jsx)("div",{"data-slot":"alert-description",className:(0,d.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",a),...c})}a.s(["Alert",()=>f,"AlertDescription",()=>g],24348);let h=(0,a.i(70106).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);a.s(["Save",()=>h],14548)},14011,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(56025),e=a.i(70988),f=a.i(99570),g=a.i(66718),h=a.i(70430),i=a.i(5084),j=a.i(24348),k=a.i(23292),l=a.i(30748);let m=(0,a.i(70106).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var n=a.i(14548),o=a.i(73570);function p(){let{user:a,login:p}=(0,d.useAuth)(),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)({username:a?.username||"",profile:a?.profile||""}),u=async b=>{if(b.preventDefault(),!s.username.trim())return void k.toast.error("กรุณากรอกชื่อผู้ใช้งาน");if(s.username.length<3)return void k.toast.error("ชื่อผู้ใช้งานต้องมีอย่างน้อย 3 ตัวอักษร");if(s.username.length>30)return void k.toast.error("ชื่อผู้ใช้งานต้องไม่เกิน 30 ตัวอักษร");if(s.profile.trim())try{let a=new URL(s.profile.trim());if(!["http:","https:"].includes(a.protocol))return void k.toast.error("URL รูปโปรไฟล์ต้องเป็น HTTP หรือ HTTPS")}catch{k.toast.error("URL รูปโปรไฟล์ไม่ถูกต้อง");return}r(!0);try{let b=await fetch("/api/auth/update-profile",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({username:s.username.trim(),profile:s.profile.trim()||null})}),c=await b.json();if(c.success){if(k.toast.success("อัปเดตข้อมูลส่วนตัวสำเร็จ"),a){let b={...a,...c.data.user},d=localStorage.getItem("auth_token");d&&await p(d,b)}}else k.toast.error(c.message)}catch(a){k.toast.error("เกิดข้อผิดพลาดในการอัปเดตข้อมูลส่วนตัว")}finally{r(!1)}},v=()=>s.username!==(a?.username||"")||s.profile!==(a?.profile||"");return(0,b.jsx)(e.default,{children:(0,b.jsxs)("main",{className:"min-h-screen",children:[(0,b.jsx)("div",{className:"flex justify-center border-b",children:(0,b.jsxs)("div",{className:"w-full max-w-5xl border-x p-3",children:[(0,b.jsx)("h1",{className:"text-lg font-medium",children:"การตั้งค่า"}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"จัดการข้อมูลส่วนตัวและการตั้งค่าบัญชีของคุณ"})]})}),(0,b.jsx)("div",{className:"flex justify-center border-b",children:(0,b.jsxs)("div",{className:"w-full max-w-5xl border-x p-3 space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"flex items-center gap-2 text-base font-medium",children:[(0,b.jsx)(l.UserIcon,{className:"h-5 w-5"}),"ข้อมูลส่วนตัว"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"แก้ไขข้อมูลส่วนตัวและรูปโปรไฟล์ของคุณ"})]}),(0,b.jsxs)("div",{className:"rounded-md border p-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h3",{className:"flex items-center gap-2 text-base font-medium",children:[(0,b.jsx)(l.UserIcon,{className:"h-4 w-4"}),"แก้ไขข้อมูลส่วนตัว"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"อัปเดตข้อมูลส่วนตัวของคุณ"})]}),(0,b.jsxs)("div",{className:"space-y-3 mt-3",children:[(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"rounded-md border p-3 flex items-start gap-3 bg-muted/50",children:[(0,b.jsx)("div",{className:"bg-zinc-100 p-2 rounded-md text-zinc-800",children:(0,b.jsx)(l.UserIcon,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(h.Label,{className:"text-xs font-medium text-gray-500",children:"ชื่อผู้ใช้งานปัจจุบัน"}),(0,b.jsx)("p",{className:"text-sm font-medium text-black",children:a?.username})]})]}),a?.profile&&(0,b.jsxs)("div",{className:"rounded-md border p-3 flex items-start gap-3 bg-muted/50",children:[(0,b.jsx)("div",{className:"bg-zinc-100 p-2 rounded-md text-zinc-800",children:(0,b.jsx)(m,{className:"w-4 h-4"})}),(0,b.jsxs)("div",{className:"flex-1",children:[(0,b.jsx)(h.Label,{className:"text-xs font-medium text-gray-500",children:"รูปโปรไฟล์ปัจจุบัน"}),(0,b.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,b.jsx)("img",{src:a.profile,alt:"Current profile",className:"w-8 h-8 rounded-full object-cover border"}),(0,b.jsx)("span",{className:"text-xs text-muted-foreground truncate flex-1",children:a.profile})]})]})]})]}),(0,b.jsx)(i.Separator,{}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("h3",{className:"text-sm font-medium",children:"แก้ไขข้อมูล"}),(0,b.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{className:"font-normal",htmlFor:"username",children:"ชื่อผู้ใช้งาน *"}),(0,b.jsx)(g.Input,{id:"username",type:"text",placeholder:"กรุณากรอกชื่อผู้ใช้งาน",value:s.username,onChange:a=>t({...s,username:a.target.value}),required:!0,maxLength:30}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"3-30 ตัวอักษร"})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{className:"font-normal",htmlFor:"profile",children:"รูปโปรไฟล์ (URL)"}),(0,b.jsx)(g.Input,{id:"profile",type:"url",placeholder:"https://example.com/avatar.jpg",value:s.profile,onChange:a=>t({...s,profile:a.target.value})}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"URL รูปภาพสำหรับโปรไฟล์ (ไม่บังคับ)"})]}),s.profile&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(h.Label,{className:"font-normal",children:"ตัวอย่างรูปโปรไฟล์"}),(0,b.jsxs)("div",{className:"flex items-center gap-3 p-3 border rounded-md",children:[(0,b.jsx)("img",{src:s.profile,alt:"Profile preview",className:"w-12 h-12 rounded-full object-cover border",onError:a=>{a.currentTarget.style.display="none"}}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"รูปโปรไฟล์"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"ตัวอย่างการแสดงผล"})]})]})]}),(0,b.jsx)(i.Separator,{}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsxs)(f.Button,{className:"flex-1 cursor-pointer",type:"submit",disabled:q||!v(),children:[(0,b.jsx)(n.Save,{className:"h-4 w-4 mr-2"}),q?"กำลังบันทึก...":"บันทึกการเปลี่ยนแปลง"]}),v()&&(0,b.jsx)(f.Button,{type:"button",variant:"outline",className:"flex-1 cursor-pointer",onClick:()=>t({username:a?.username||"",profile:a?.profile||""}),disabled:q,children:"ยกเลิกการเปลี่ยนแปลง"})]})]})]})]})]}),v()&&(0,b.jsxs)(j.Alert,{children:[(0,b.jsx)(o.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsx)(j.AlertDescription,{children:"คุณมีการเปลี่ยนแปลงที่ยังไม่ได้บันทึก กรุณากดบันทึกเพื่ออัปเดตข้อมูล"})]})]})})]})})}a.s(["default",()=>p],14011)}];

//# sourceMappingURL=_db1593a3._.js.map