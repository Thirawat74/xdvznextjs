module.exports=[3218,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(99570),e=a.i(66718),f=a.i(70430),g=a.i(24348),h=a.i(14574),i=a.i(68114);function j({direction:a="left",className:d,width:e=10,height:f=10,...g}){let h=(0,c.useId)(),j=Number(e),k=Number(f);return(0,b.jsxs)("svg",{"aria-hidden":"true",className:(0,i.cn)("pointer-events-none absolute inset-0 z-10 h-full w-full stroke-[0.5]",d),xmlns:"http://www.w3.org/2000/svg",...g,children:[(0,b.jsx)("defs",{children:(0,b.jsx)("pattern",{id:h,width:j,height:k,patternUnits:"userSpaceOnUse",children:"left"===a?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("line",{x1:"0",y1:k,x2:j,y2:"0",stroke:"currentColor"}),(0,b.jsx)("line",{x1:-j,y1:k,x2:"0",y2:"0",stroke:"currentColor"}),(0,b.jsx)("line",{x1:j,y1:k,x2:2*j,y2:"0",stroke:"currentColor"})]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)("line",{x1:"0",y1:"0",x2:j,y2:k,stroke:"currentColor"}),(0,b.jsx)("line",{x1:-j,y1:"0",x2:"0",y2:k,stroke:"currentColor"}),(0,b.jsx)("line",{x1:j,y1:"0",x2:2*j,y2:k,stroke:"currentColor"})]})})}),(0,b.jsx)("rect",{width:"100%",height:"100%",fill:`url(#${h})`})]})}var k=a.i(30769),l=a.i(70106);let m=(0,l.default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);var n=a.i(96391),n=n,o=a.i(13773),p=a.i(38500),q=a.i(30748),r=a.i(86304),s=a.i(69876),t=a.i(75083),u=a.i(3314),v=a.i(1631),w=a.i(73570),x=a.i(16201),y=a.i(62722),z=a.i(77156),A=a.i(41379),B=a.i(14548);let C=(0,l.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var D=a.i(46842),E=a.i(23237),F=a.i(5151);let G=(0,l.default)("scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]),H=(0,l.default)("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),I=(0,l.default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),J=(0,l.default)("camera-off",[["path",{d:"M14.564 14.558a3 3 0 1 1-4.122-4.121",key:"1rnrzw"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M20 20H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 .819-.175",key:"1x3arw"}],["path",{d:"M9.695 4.024A2 2 0 0 1 10.004 4h3.993a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v7.344",key:"1i84u0"}]]);var K=a.i(23292);function L({onScanSuccess:a,onClose:e}){let f=(0,c.useRef)(null),g=(0,c.useRef)(null),[h,i]=(0,c.useState)(!1),[j,k]=(0,c.useState)(null),l=async()=>{try{k(null);let a=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280,max:1920},height:{ideal:720,max:1080},facingMode:"environment",frameRate:{ideal:30,max:60}},audio:!1});g.current=a,f.current&&(f.current.srcObject=a,i(!0),K.toast.success("เปิดกล้องสำเร็จ"))}catch(b){console.error("Error accessing camera:",b);let a="ไม่สามารถเข้าถึงกล้องได้";b instanceof Error&&("NotAllowedError"===b.name?a="กรุณาอนุญาตการเข้าถึงกล้อง":"NotFoundError"===b.name?a="ไม่พบกล้องในอุปกรณ์นี้":"NotReadableError"===b.name&&(a="กล้องถูกใช้งานโดยแอปพลิเคชันอื่น")),k(a),K.toast.error(a)}};return(0,c.useEffect)(()=>()=>{g.current&&g.current.getTracks().forEach(a=>a.stop())},[]),(0,b.jsxs)("div",{className:"space-y-4 w-full mx-auto",children:[(0,b.jsxs)("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,b.jsx)(I,{className:"w-5 h-5"})," สแกน QR Code"]}),j&&(0,b.jsxs)("div",{className:"p-3 bg-red-100 border border-red-300 rounded text-red-700 text-sm flex gap-2 items-center",children:[(0,b.jsx)(y.XCircle,{className:"w-4 h-4"}),j]}),h?(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsx)("div",{className:"relative",children:(0,b.jsx)("video",{ref:f,className:"w-full h-64 bg-black rounded-lg object-cover",autoPlay:!0,playsInline:!0,muted:!0})}),(0,b.jsxs)(d.Button,{onClick:()=>{g.current&&(g.current.getTracks().forEach(a=>a.stop()),g.current=null),f.current&&(f.current.srcObject=null),i(!1),k(null),K.toast.success("ปิดกล้องแล้ว")},className:"w-full",variant:"outline",children:[(0,b.jsx)(J,{className:"w-4 h-4 mr-2"}),"ปิดกล้อง"]})]}):(0,b.jsxs)(d.Button,{onClick:l,className:"w-full",children:[(0,b.jsx)(I,{className:"w-4 h-4 mr-2"}),"เปิดกล้อง"]}),(0,b.jsx)(d.Button,{onClick:e,variant:"outline",className:"w-full",children:"ปิดหน้าต่าง"})]})}var M=a.i(56025),N=a.i(70988);function O(){let{user:a}=(0,M.useAuth)(),[i,l]=(0,c.useState)(!1),[I,J]=(0,c.useState)(!1),[O,P]=(0,c.useState)(!1),[Q,R]=(0,c.useState)(!1),[S,T]=(0,c.useState)(!1),[U,V]=(0,c.useState)({secret:"",qrCodeUrl:"",otpauth_url:"",token:""}),[W,X]=(0,c.useState)(!1),[Y,Z]=(0,c.useState)(!1),[$,_]=(0,c.useState)(!1),[aa,ab]=(0,c.useState)(null),[ac,ad]=(0,c.useState)(!1),[ae,af]=(0,c.useState)({sessionId:"",twoFactorToken:""}),[ag,ah]=(0,c.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),ai=async a=>{if(a.preventDefault(),ag.newPassword!==ag.confirmPassword)return void K.toast.error("รหัสผ่านใหม่ไม่ตรงกัน");if(ag.newPassword.length<8)return void K.toast.error("รหัสผ่านใหม่ต้องมีอย่างน้อย 8 ตัวอักษร");l(!0);try{let a=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({currentPassword:ag.currentPassword,newPassword:ag.newPassword})}),b=await a.json();b.success?(K.toast.success("เปลี่ยนรหัสผ่านสำเร็จ"),ah({currentPassword:"",newPassword:"",confirmPassword:""})):K.toast.error(b.message)}catch(a){K.toast.error("เกิดข้อผิดพลาดในการเปลี่ยนรหัสผ่าน")}finally{l(!1)}},aj=async()=>{l(!0);try{let a=await fetch("/api/auth/2fa/setup",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),b=await a.json();b.success?(V({secret:b.data.secret,qrCodeUrl:b.data.qrCodeUrl,otpauth_url:b.data.otpauth_url,token:""}),X(!0),K.toast.success("สร้าง QR Code สำเร็จ")):K.toast.error(b.message)}catch(a){K.toast.error("เกิดข้อผิดพลาดในการตั้งค่า 2FA")}finally{l(!1)}},ak=async a=>{a.preventDefault(),l(!0);try{let a=await fetch("/api/auth/2fa/verify",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({secret:U.secret,token:U.token})}),b=await a.json();b.success?(X(!1),V({secret:"",qrCodeUrl:"",otpauth_url:"",token:""}),K.toast.success("เปิดใช้งาน 2FA สำเร็จ"),window.location.reload()):K.toast.error(b.message)}catch(a){K.toast.error("เกิดข้อผิดพลาดในการยืนยัน 2FA")}finally{l(!1)}},al=async()=>{l(!0);try{let a=await fetch("/api/auth/2fa/disable",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),b=await a.json();b.success?(Z(!1),K.toast.success("ปิดใช้งาน 2FA สำเร็จ"),window.location.reload()):K.toast.error(b.message)}catch(a){K.toast.error("เกิดข้อผิดพลาดในการปิดใช้งาน 2FA")}finally{l(!1)}},am=async()=>{l(!0);try{let a=await fetch("/api/auth/logout-all",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),b=await a.json();b.success?(K.toast.success("ออกจากระบบทุกอุปกรณ์สำเร็จ"),T(!1),localStorage.removeItem("auth_token"),window.location.href="/"):K.toast.error(b.message)}catch(a){K.toast.error("เกิดข้อผิดพลาดในการออกจากระบบ")}finally{l(!1)}},an=async a=>{try{let b=await fetch("/api/auth/qr/scan",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({qrData:a})}),c=await b.json();c.success?(ab(c.sessionId),af({sessionId:c.sessionId,twoFactorToken:""}),_(!1),ad(!0),K.toast.success("QR Code สแกนสำเร็จ")):K.toast.error(c.message||"QR Code ไม่ถูกต้องหรือหมดอายุ")}catch(a){console.error("QR scan error:",a),K.toast.error("เกิดข้อผิดพลาดในการสแกน QR Code")}},ao=async()=>{l(!0);try{let b={sessionId:ae.sessionId};if(a?.twoFactorEnabled){if(!ae.twoFactorToken)return void K.toast.error("กรุณาป้อนรหัส 2FA");b.twoFactorToken=ae.twoFactorToken}let c=await fetch("/api/auth/qr/verify",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify(b)}),d=await c.json();d.success?(K.toast.success("เข้าสู่ระบบสำเร็จ! อุปกรณ์อื่นได้เข้าสู่ระบบแล้ว"),ad(!1),af({sessionId:"",twoFactorToken:""})):K.toast.error(d.message||"การยืนยันล้มเหลว")}catch(a){console.error("QR verify error:",a),K.toast.error("เกิดข้อผิดพลาดในการยืนยัน")}finally{l(!1)}};return(0,b.jsx)(N.default,{children:(0,b.jsxs)("main",{className:"min-h-screen",children:[(0,b.jsx)("div",{className:"flex justify-center border-b",children:(0,b.jsxs)("div",{className:"w-full max-w-5xl border-x p-3",children:[(0,b.jsx)("h1",{className:"text-lg font-medium",children:"ความปลอดภัยของบัญชี"}),(0,b.jsx)("p",{className:"text-muted-foreground text-xs",children:"จัดการการตั้งค่าความปลอดภัยและข้อมูลส่วนตัวของคุณ"})]})}),(0,b.jsx)("div",{className:"flex justify-center border-b",children:(0,b.jsxs)("div",{className:"w-full max-w-5xl border-x p-3 space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h1",{className:"flex items-center gap-2 text-base font-medium",children:[(0,b.jsx)(u.Shield,{className:"h-5 w-5"}),"สถานะความปลอดภัย"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"ตรวจสอบระดับความปลอดภัยของบัญชีของคุณ"})]}),(0,b.jsx)("div",{children:(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,b.jsx)("div",{className:"flex items-center gap-3 p-3 border rounded-md",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:"รหัสผ่าน"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"ตั้งค่าแล้ว"})]})}),(0,b.jsx)("div",{className:`flex items-center gap-3 p-3 border rounded-md ${a?.twoFactorEnabled?"":"opacity-50 select-none relative"}`,children:a?.twoFactorEnabled?(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:"การยืนยันตัวตน 2 ชั้น"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"เปิดใช้งานแล้ว"})]})}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(j,{className:"opacity-50"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:"การยืนยันตัวตน 2 ชั้น"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"ยังไม่ได้ตั้งค่า"})]})]})}),(0,b.jsx)("div",{className:"flex items-center gap-3 p-3 border rounded-md",children:(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium text-sm",children:"อีเมล"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"ยืนยันแล้ว"})]})})]})})]})}),(0,b.jsx)("div",{className:"flex justify-center border-b",children:(0,b.jsx)("div",{className:"w-full max-w-5xl border-x p-3 space-y-3",children:(0,b.jsxs)(t.Tabs,{defaultValue:"tab-1",children:[(0,b.jsxs)(s.ScrollArea,{children:[(0,b.jsxs)(t.TabsList,{className:"mb-3 w-full",children:[(0,b.jsxs)(t.TabsTrigger,{value:"tab-1",children:[(0,b.jsx)(m,{"aria-hidden":"true",className:"-ms-0.5 me-1.5 opacity-60",size:16}),"เปลี่ยนรหัสผ่าน"]}),(0,b.jsxs)(t.TabsTrigger,{className:"group",value:"tab-2",children:[(0,b.jsx)(q.UserIcon,{"aria-hidden":"true",className:"-ms-0.5 me-1.5 opacity-60",size:16}),"ข้อมูลบัญชี",(0,b.jsx)(r.Badge,{className:"ms-1.5 min-w-5 bg-primary/15 px-1 transition-opacity group-data-[state=inactive]:opacity-50",variant:"secondary",children:"3"})]}),(0,b.jsxs)(t.TabsTrigger,{className:"group",value:"tab-3",children:[(0,b.jsx)(v.Smartphone,{"aria-hidden":"true",className:"-ms-0.5 me-1.5 opacity-60",size:16}),"2FA",a?.twoFactorEnabled&&(0,b.jsx)(r.Badge,{variant:"secondary",children:"เปิดใช้งานแล้ว"})]}),(0,b.jsxs)(t.TabsTrigger,{className:"group",value:"tab-5",children:[(0,b.jsx)(G,{"aria-hidden":"true",className:"-ms-0.5 me-1.5 opacity-60",size:16}),"QR เข้าสู่ระบบ",(0,b.jsx)(r.Badge,{className:"ms-1.5 transition-opacity group-data-[state=inactive]:opacity-50",children:"New"})]}),(0,b.jsxs)(t.TabsTrigger,{className:"group",value:"tab-4",children:[(0,b.jsx)(n.default,{"aria-hidden":"true",className:"-ms-0.5 me-1.5 opacity-60",size:16}),"การจัดการเซสชัน",(0,b.jsx)(r.Badge,{className:"ms-1.5 transition-opacity group-data-[state=inactive]:opacity-50",children:"New"})]})]}),(0,b.jsx)(s.ScrollBar,{orientation:"horizontal"})]}),(0,b.jsx)(t.TabsContent,{value:"tab-1",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"flex items-center gap-2 text-base font-medium",children:[(0,b.jsx)(m,{className:"h-5 w-5"}),"เปลี่ยนรหัสผ่าน"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"เปลี่ยนรหัสผ่านเพื่อเพิ่มความปลอดภัยให้กับบัญชีของคุณ"})]}),(0,b.jsx)("div",{children:(0,b.jsxs)("form",{onSubmit:ai,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Label,{className:"font-normal",htmlFor:"current-password",children:"รหัสผ่านปัจจุบัน"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(e.Input,{id:"current-password",type:I?"text":"password",placeholder:"กรุณาป้อนรหัสผ่านปัจจุบัน",value:ag.currentPassword,onChange:a=>ah({...ag,currentPassword:a.target.value}),required:!0}),(0,b.jsx)(d.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>J(!I),children:I?(0,b.jsx)(A.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(z.Eye,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Label,{className:"font-normal",htmlFor:"new-password",children:"รหัสผ่านใหม่"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(e.Input,{id:"new-password",type:O?"text":"password",placeholder:"กรุณาป้อนรหัสผ่านใหม่",value:ag.newPassword,onChange:a=>ah({...ag,newPassword:a.target.value}),required:!0}),(0,b.jsx)(d.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>P(!O),children:O?(0,b.jsx)(A.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(z.Eye,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Label,{className:"font-normal",htmlFor:"confirm-password",children:"ยืนยันรหัสผ่านใหม่"}),(0,b.jsxs)("div",{className:"relative",children:[(0,b.jsx)(e.Input,{id:"confirm-password",type:Q?"text":"password",placeholder:"กรุณายืนยันรหัสผ่านใหม่",value:ag.confirmPassword,onChange:a=>ah({...ag,confirmPassword:a.target.value}),required:!0}),(0,b.jsx)(d.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>R(!Q),children:Q?(0,b.jsx)(A.EyeOff,{className:"h-4 w-4"}):(0,b.jsx)(z.Eye,{className:"h-4 w-4"})})]})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsxs)(d.Button,{className:"w-full cursor-pointer",type:"submit",disabled:i,children:[(0,b.jsx)(B.Save,{className:"h-4 w-4"}),i?"กำลังเปลี่ยน...":"เปลี่ยนรหัสผ่าน"]})})]})})]})}),(0,b.jsx)(t.TabsContent,{value:"tab-2",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"flex items-center gap-2 text-base font-medium",children:[(0,b.jsx)(D.User,{className:"h-5 w-5"}),"ข้อมูลบัญชี"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"ข้อมูลพื้นฐานของบัญชีของคุณ"})]}),(0,b.jsx)("div",{children:(0,b.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,b.jsxs)("div",{className:"rounded-md border p-2 flex items-start gap-2",children:[(0,b.jsx)("div",{className:"bg-zinc-100 p-2 rounded-md text-zinc-800 ",children:(0,b.jsx)(q.UserIcon,{className:"w-6 h-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(f.Label,{className:"text-xs font-medium text-gray-500",children:"ชื่อผู้ใช้งาน"}),(0,b.jsx)("p",{className:"text-sm text-black",children:a?.username})]})]}),(0,b.jsxs)("div",{className:"rounded-md border p-2 flex items-start gap-2",children:[(0,b.jsx)("div",{className:"bg-zinc-100 p-2 rounded-md text-zinc-800 ",children:(0,b.jsx)(o.MailIcon,{className:"w-6 h-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(f.Label,{className:"text-xs font-medium text-gray-500",children:"อีเมล"}),(0,b.jsx)("p",{className:"text-sm text-black",children:a?.email})]})]}),(0,b.jsxs)("div",{className:"rounded-md border p-2 flex items-start gap-2",children:[(0,b.jsx)("div",{className:"bg-zinc-100 p-2 rounded-md text-zinc-800 ",children:(0,b.jsx)(p.ShieldCheckIcon,{className:"w-6 h-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(f.Label,{className:"text-xs font-medium text-gray-500",children:"ระดับผู้ใช้"}),(0,b.jsx)(r.Badge,{variant:a?.role===1?"default":"secondary",className:"text-sm text-black",children:a?.role===1?"ผู้ดูแลระบบ":"ผู้ใช้ทั่วไป"})]})]}),(0,b.jsxs)("div",{className:"rounded-md border p-2 flex items-start gap-2",children:[(0,b.jsx)("div",{className:"bg-zinc-100 p-2 rounded-md text-zinc-800 ",children:(0,b.jsx)(k.CalendarIcon,{className:"w-6 h-6"})}),(0,b.jsxs)("div",{children:[(0,b.jsx)(f.Label,{className:"text-xs font-medium text-gray-500",children:"วันที่สร้างบัญชี"}),(0,b.jsx)("p",{className:"text-sm text-black",children:a?.time?new Date(a.time).toLocaleDateString("th-TH"):"ไม่ระบุ"})]})]})]})})]})}),(0,b.jsx)(t.TabsContent,{value:"tab-3",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"flex items-center gap-2 text-base font-medium",children:[(0,b.jsx)(v.Smartphone,{className:"h-5 w-5"}),"การยืนยันตัวตน 2 ชั้น (2FA)"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"เพิ่มความปลอดภัยให้กับบัญชีของคุณด้วย Google Authenticator"})]}),(0,b.jsx)("div",{children:a?.twoFactorEnabled?(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)(g.Alert,{children:[(0,b.jsx)(x.CheckCircle,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertDescription,{children:"การยืนยันตัวตน 2 ชั้นเปิดใช้งานแล้ว"})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsxs)(d.Button,{className:"w-full cursor-pointer",variant:"destructive",onClick:()=>Z(!0),disabled:i,children:[(0,b.jsx)(y.XCircle,{className:"h-4 w-4"}),"ปิดใช้งาน 2FA"]})})]}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)(g.Alert,{children:[(0,b.jsx)(w.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertDescription,{children:"การยืนยันตัวตน 2 ชั้นยังไม่ได้เปิดใช้งาน"})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsxs)(d.Button,{className:"w-full cursor-pointer",onClick:aj,disabled:i,children:[(0,b.jsx)(E.QrCode,{className:"h-4 w-4"}),"เปิดใช้งาน 2FA"]})})]})})]})}),(0,b.jsx)(t.TabsContent,{value:"tab-4",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"flex items-center gap-2 text-base font-medium",children:[(0,b.jsx)(v.Smartphone,{className:"h-5 w-5"}),"การจัดการเซสชัน"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"จัดการอุปกรณ์ที่เข้าสู่ระบบด้วยบัญชีนี้"})]}),(0,b.jsxs)("div",{children:[(0,b.jsxs)(g.Alert,{children:[(0,b.jsx)(w.AlertTriangle,{className:"h-4 w-4"}),(0,b.jsx)(g.AlertDescription,{children:"การออกจากระบบทุกอุปกรณ์จะทำให้คุณต้องเข้าสู่ระบบใหม่ในทุกที่"})]}),(0,b.jsx)("div",{className:"mt-4",children:(0,b.jsxs)(d.Button,{variant:"destructive",className:"w-full cursor-pointer",onClick:()=>T(!0),disabled:i,children:[(0,b.jsx)(C,{className:"h-4 w-4"}),"ออกจากระบบทุกอุปกรณ์"]})})]})]})}),(0,b.jsx)(t.TabsContent,{value:"tab-5",children:(0,b.jsxs)("div",{className:"space-y-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)("h2",{className:"flex items-center gap-2 text-base font-medium",children:[(0,b.jsx)(G,{className:"h-5 w-5"}),"QR เข้าสู่ระบบ"]}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"สแกน QR Code เพื่ออนุญาตให้อุปกรณ์อื่นเข้าสู่ระบบ"})]}),(0,b.jsx)("div",{children:$?(0,b.jsx)(L,{onScanSuccess:an,onClose:()=>_(!1)}):(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsxs)("div",{className:"text-center py-8 space-y-4",children:[(0,b.jsx)(H,{className:"w-16 h-16 mx-auto text-muted-foreground"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"text-sm font-medium",children:"พร้อมสแกน QR Code"}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"เปิดกล้องเพื่อสแกน QR Code จากอุปกรณ์อื่น"})]})]}),(0,b.jsx)("div",{className:"flex gap-2",children:(0,b.jsxs)(d.Button,{className:"flex-1 cursor-pointer",onClick:()=>_(!0),children:[(0,b.jsx)(G,{className:"w-4 h-4 mr-2"}),"เปิดสแกนเนอร์"]})})]})})]})})]})})}),(0,b.jsx)(h.Dialog,{open:W,onOpenChange:X,children:(0,b.jsxs)(h.DialogContent,{className:"max-w-md",children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsx)(h.DialogTitle,{children:"เปิดใช้งาน 2FA"}),(0,b.jsx)(h.DialogDescription,{children:"สแกน QR Code นี้ด้วยแอพ Google Authenticator หรือแอพ 2FA อื่นๆ"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[U.qrCodeUrl&&(0,b.jsx)("div",{className:"flex justify-center",children:(0,b.jsx)("img",{src:U.qrCodeUrl,alt:"2FA QR Code",className:"w-48 h-48"})}),(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Label,{children:"Secret Key (สำรอง)"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)(e.Input,{value:U.secret,readOnly:!0,className:"font-mono text-sm"}),(0,b.jsx)(d.Button,{type:"button",variant:"outline",size:"icon",onClick:()=>{navigator.clipboard.writeText(U.secret),K.toast.success("คัดลอก Secret สำเร็จ")},children:(0,b.jsx)(F.Copy,{className:"h-4 w-4"})})]})]}),(0,b.jsxs)("form",{onSubmit:ak,className:"space-y-4",children:[(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsx)(f.Label,{children:"รหัส 6 หลักจากแอพ"}),(0,b.jsx)(e.Input,{type:"text",placeholder:"000000",value:U.token,onChange:a=>V({...U,token:a.target.value.replace(/\D/g,"").slice(0,6)}),maxLength:6,required:!0})]}),(0,b.jsxs)(h.DialogFooter,{children:[(0,b.jsx)(d.Button,{type:"button",variant:"outline",onClick:()=>{X(!1),V({secret:"",qrCodeUrl:"",otpauth_url:"",token:""})},disabled:i,children:"ยกเลิก"}),(0,b.jsx)(d.Button,{type:"submit",disabled:i||6!==U.token.length,children:i?"กำลังเปิดใช้งาน...":"เปิดใช้งาน 2FA"})]})]})]})]})}),(0,b.jsx)(h.Dialog,{open:Y,onOpenChange:Z,children:(0,b.jsxs)(h.DialogContent,{children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsx)(h.DialogTitle,{children:"ปิดใช้งาน 2FA"}),(0,b.jsx)(h.DialogDescription,{children:"คุณต้องการปิดใช้งานการยืนยันตัวตน 2 ชั้นหรือไม่? การดำเนินการนี้จะทำให้บัญชีของคุณมีความเสี่ยงมากขึ้น"})]}),(0,b.jsxs)(h.DialogFooter,{children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>Z(!1),disabled:i,children:"ยกเลิก"}),(0,b.jsx)(d.Button,{variant:"destructive",onClick:al,disabled:i,children:i?"กำลังปิดใช้งาน...":"ปิดใช้งาน 2FA"})]})]})}),(0,b.jsx)(h.Dialog,{open:S,onOpenChange:T,children:(0,b.jsxs)(h.DialogContent,{children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsx)(h.DialogTitle,{children:"ยืนยันการออกจากระบบ"}),(0,b.jsx)(h.DialogDescription,{children:"คุณต้องการออกจากระบบทุกอุปกรณ์หรือไม่? การดำเนินการนี้จะทำให้คุณต้องเข้าสู่ระบบใหม่ในทุกอุปกรณ์ที่ใช้งานบัญชีนี้"})]}),(0,b.jsxs)(h.DialogFooter,{children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>T(!1),disabled:i,children:"ยกเลิก"}),(0,b.jsx)(d.Button,{variant:"destructive",onClick:am,disabled:i,children:i?"กำลังออกจากระบบ...":"ยืนยันการออกจากระบบ"})]})]})}),(0,b.jsx)(h.Dialog,{open:ac,onOpenChange:ad,children:(0,b.jsxs)(h.DialogContent,{children:[(0,b.jsxs)(h.DialogHeader,{children:[(0,b.jsxs)(h.DialogTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(x.CheckCircle,{className:"w-5 h-5 text-green-500"}),"ยืนยันการเข้าสู่ระบบ"]}),(0,b.jsx)(h.DialogDescription,{children:"อุปกรณ์อื่นต้องการเข้าสู่ระบบด้วยบัญชีนี้"})]}),(0,b.jsxs)("div",{className:"space-y-4",children:[(0,b.jsx)("div",{className:"p-4 bg-blue-50 border rounded-lg",children:(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)(H,{className:"w-8 h-8 text-blue-500"}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-medium",children:"อุปกรณ์ใหม่"}),(0,b.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Chrome บน Windows • ",new Date().toLocaleTimeString("th-TH")]})]})]})}),a?.twoFactorEnabled&&(0,b.jsxs)("div",{className:"space-y-2",children:[(0,b.jsxs)(f.Label,{className:"font-normal flex items-center gap-2",children:[(0,b.jsx)(u.Shield,{className:"w-4 h-4"}),"รหัส 2FA (6 หลัก)"]}),(0,b.jsx)("input",{type:"text",value:ae.twoFactorToken,onChange:a=>af(b=>({...b,twoFactorToken:a.target.value.replace(/\D/g,"").slice(0,6)})),className:"w-full p-2 border rounded-md text-center text-lg font-mono",placeholder:"000000",maxLength:6}),(0,b.jsx)("p",{className:"text-xs text-muted-foreground",children:"ป้อนรหัสจากแอพ Google Authenticator"})]}),(0,b.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,b.jsx)("p",{children:"⚠️ ตรวจสอบให้แน่ใจว่าคุณรู้จักอุปกรณ์นี้"}),(0,b.jsx)("p",{children:"การยืนยันนี้จะอนุญาตให้อุปกรณ์เข้าถึงบัญชีของคุณ"})]})]}),(0,b.jsxs)(h.DialogFooter,{children:[(0,b.jsx)(d.Button,{variant:"outline",onClick:()=>{ad(!1),af({sessionId:"",twoFactorToken:""})},disabled:i,children:"ยกเลิก"}),(0,b.jsx)(d.Button,{onClick:ao,disabled:i||a?.twoFactorEnabled&&6!==ae.twoFactorToken.length,children:i?"กำลังยืนยัน...":"อนุญาตเข้าสู่ระบบ"})]})]})})]})})}a.s(["default",()=>O],3218)}];

//# sourceMappingURL=src_app_account_setting_security_page_tsx_ebe53a3e._.js.map