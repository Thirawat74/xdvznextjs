(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,76015,e=>{"use strict";var s=e.i(43476),a=e.i(32341),t=e.i(18566),r=e.i(71645),l=e.i(87968);function i({children:e}){let{isAuth:i,loading:c}=(0,a.useAuth)(),n=(0,t.useRouter)();return((0,r.useEffect)(()=>{c||i||n.push("/")},[i,c,n]),c)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(l.Spinner,{})}):i?(0,s.jsx)(s.Fragment,{children:e}):null}e.s(["default",()=>i])},61277,69638,e=>{"use strict";var s=e.i(75254);let a=(0,s.default)("calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);e.s(["default",()=>a],61277);let t=(0,s.default)("circle-check-big",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);e.s(["CheckCircle",()=>t],69638)},73884,74886,e=>{"use strict";var s=e.i(75254);let a=(0,s.default)("circle-x",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);e.s(["XCircle",()=>a],73884);let t=(0,s.default)("copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);e.s(["Copy",()=>t],74886)},60507,78894,e=>{"use strict";var s=e.i(46753);e.s(["UserIcon",()=>s.default],60507);var a=e.i(74296);e.s(["AlertTriangle",()=>a.default],78894)},47697,e=>{"use strict";var s=e.i(61277);e.s(["CalendarIcon",()=>s.default])},70682,99237,e=>{"use strict";var s=e.i(68214);e.s(["MailIcon",()=>s.default],70682);let a=(0,e.i(75254).default)("shield-check",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);e.s(["ShieldCheckIcon",()=>a],99237)},29592,56909,e=>{"use strict";var s=e.i(43476),a=e.i(25913),t=e.i(75157);let r=(0,a.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function l({className:e,variant:a,...l}){return(0,s.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,t.cn)(r({variant:a}),e),...l})}function i({className:e,...a}){return(0,s.jsx)("div",{"data-slot":"alert-description",className:(0,t.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...a})}e.s(["Alert",()=>l,"AlertDescription",()=>i],29592);let c=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>c],56909)},43825,e=>{"use strict";var s=e.i(43476),a=e.i(71645),t=e.i(19455),r=e.i(93479),l=e.i(10204),i=e.i(29592),c=e.i(76639),n=e.i(75157);function o({direction:e="left",className:t,width:r=10,height:l=10,...i}){let c=(0,a.useId)(),o=Number(r),d=Number(l);return(0,s.jsxs)("svg",{"aria-hidden":"true",className:(0,n.cn)("pointer-events-none absolute inset-0 z-10 h-full w-full stroke-[0.5]",t),xmlns:"http://www.w3.org/2000/svg",...i,children:[(0,s.jsx)("defs",{children:(0,s.jsx)("pattern",{id:c,width:o,height:d,patternUnits:"userSpaceOnUse",children:"left"===e?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("line",{x1:"0",y1:d,x2:o,y2:"0",stroke:"currentColor"}),(0,s.jsx)("line",{x1:-o,y1:d,x2:"0",y2:"0",stroke:"currentColor"}),(0,s.jsx)("line",{x1:o,y1:d,x2:2*o,y2:"0",stroke:"currentColor"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("line",{x1:"0",y1:"0",x2:o,y2:d,stroke:"currentColor"}),(0,s.jsx)("line",{x1:-o,y1:"0",x2:"0",y2:d,stroke:"currentColor"}),(0,s.jsx)("line",{x1:o,y1:"0",x2:2*o,y2:d,stroke:"currentColor"})]})})}),(0,s.jsx)("rect",{width:"100%",height:"100%",fill:`url(#${c})`})]})}var d=e.i(47697),x=e.i(75254);let h=(0,x.default)("key",[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]]);var m=e.i(18820),m=m,u=e.i(70682),j=e.i(99237),p=e.i(60507),g=e.i(87486),v=e.i(59684),f=e.i(77572),y=e.i(98919),N=e.i(26707),w=e.i(78894),b=e.i(69638),k=e.i(73884),C=e.i(86536),S=e.i(77705),T=e.i(56909);let A=(0,x.default)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]]);var F=e.i(84614),D=e.i(23962),z=e.i(74886);let B=(0,x.default)("scan",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]),I=(0,x.default)("monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]),P=(0,x.default)("camera",[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),M=(0,x.default)("camera-off",[["path",{d:"M14.564 14.558a3 3 0 1 1-4.122-4.121",key:"1rnrzw"}],["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M20 20H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 .819-.175",key:"1x3arw"}],["path",{d:"M9.695 4.024A2 2 0 0 1 10.004 4h3.993a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v7.344",key:"1i84u0"}]]);var O=e.i(46696);function E({onScanSuccess:e,onClose:r}){let l=(0,a.useRef)(null),i=(0,a.useRef)(null),[c,n]=(0,a.useState)(!1),[o,d]=(0,a.useState)(null),x=async()=>{try{d(null);let e=await navigator.mediaDevices.getUserMedia({video:{width:{ideal:1280,max:1920},height:{ideal:720,max:1080},facingMode:"environment",frameRate:{ideal:30,max:60}},audio:!1});i.current=e,l.current&&(l.current.srcObject=e,n(!0),O.toast.success("เปิดกล้องสำเร็จ"))}catch(s){console.error("Error accessing camera:",s);let e="ไม่สามารถเข้าถึงกล้องได้";s instanceof Error&&("NotAllowedError"===s.name?e="กรุณาอนุญาตการเข้าถึงกล้อง":"NotFoundError"===s.name?e="ไม่พบกล้องในอุปกรณ์นี้":"NotReadableError"===s.name&&(e="กล้องถูกใช้งานโดยแอปพลิเคชันอื่น")),d(e),O.toast.error(e)}};return(0,a.useEffect)(()=>()=>{i.current&&i.current.getTracks().forEach(e=>e.stop())},[]),(0,s.jsxs)("div",{className:"space-y-4 w-full mx-auto",children:[(0,s.jsxs)("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[(0,s.jsx)(P,{className:"w-5 h-5"})," สแกน QR Code"]}),o&&(0,s.jsxs)("div",{className:"p-3 bg-red-100 border border-red-300 rounded text-red-700 text-sm flex gap-2 items-center",children:[(0,s.jsx)(k.XCircle,{className:"w-4 h-4"}),o]}),c?(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("div",{className:"relative",children:(0,s.jsx)("video",{ref:l,className:"w-full h-64 bg-black rounded-lg object-cover",autoPlay:!0,playsInline:!0,muted:!0})}),(0,s.jsxs)(t.Button,{onClick:()=>{i.current&&(i.current.getTracks().forEach(e=>e.stop()),i.current=null),l.current&&(l.current.srcObject=null),n(!1),d(null),O.toast.success("ปิดกล้องแล้ว")},className:"w-full",variant:"outline",children:[(0,s.jsx)(M,{className:"w-4 h-4 mr-2"}),"ปิดกล้อง"]})]}):(0,s.jsxs)(t.Button,{onClick:x,className:"w-full",children:[(0,s.jsx)(P,{className:"w-4 h-4 mr-2"}),"เปิดกล้อง"]}),(0,s.jsx)(t.Button,{onClick:r,variant:"outline",className:"w-full",children:"ปิดหน้าต่าง"})]})}var R=e.i(32341),q=e.i(76015);function L(){let{user:e}=(0,R.useAuth)(),[n,x]=(0,a.useState)(!1),[P,M]=(0,a.useState)(!1),[L,U]=(0,a.useState)(!1),[_,Q]=(0,a.useState)(!1),[H,V]=(0,a.useState)(!1),[$,J]=(0,a.useState)({secret:"",qrCodeUrl:"",otpauth_url:"",token:""}),[G,K]=(0,a.useState)(!1),[X,W]=(0,a.useState)(!1),[Y,Z]=(0,a.useState)(!1),[ee,es]=(0,a.useState)(null),[ea,et]=(0,a.useState)(!1),[er,el]=(0,a.useState)({sessionId:"",twoFactorToken:""}),[ei,ec]=(0,a.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),en=async e=>{if(e.preventDefault(),ei.newPassword!==ei.confirmPassword)return void O.toast.error("รหัสผ่านใหม่ไม่ตรงกัน");if(ei.newPassword.length<8)return void O.toast.error("รหัสผ่านใหม่ต้องมีอย่างน้อย 8 ตัวอักษร");x(!0);try{let e=await fetch("/api/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({currentPassword:ei.currentPassword,newPassword:ei.newPassword})}),s=await e.json();s.success?(O.toast.success("เปลี่ยนรหัสผ่านสำเร็จ"),ec({currentPassword:"",newPassword:"",confirmPassword:""})):O.toast.error(s.message)}catch(e){O.toast.error("เกิดข้อผิดพลาดในการเปลี่ยนรหัสผ่าน")}finally{x(!1)}},eo=async()=>{x(!0);try{let e=await fetch("/api/auth/2fa/setup",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),s=await e.json();s.success?(J({secret:s.data.secret,qrCodeUrl:s.data.qrCodeUrl,otpauth_url:s.data.otpauth_url,token:""}),K(!0),O.toast.success("สร้าง QR Code สำเร็จ")):O.toast.error(s.message)}catch(e){O.toast.error("เกิดข้อผิดพลาดในการตั้งค่า 2FA")}finally{x(!1)}},ed=async e=>{e.preventDefault(),x(!0);try{let e=await fetch("/api/auth/2fa/verify",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({secret:$.secret,token:$.token})}),s=await e.json();s.success?(K(!1),J({secret:"",qrCodeUrl:"",otpauth_url:"",token:""}),O.toast.success("เปิดใช้งาน 2FA สำเร็จ"),window.location.reload()):O.toast.error(s.message)}catch(e){O.toast.error("เกิดข้อผิดพลาดในการยืนยัน 2FA")}finally{x(!1)}},ex=async()=>{x(!0);try{let e=await fetch("/api/auth/2fa/disable",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),s=await e.json();s.success?(W(!1),O.toast.success("ปิดใช้งาน 2FA สำเร็จ"),window.location.reload()):O.toast.error(s.message)}catch(e){O.toast.error("เกิดข้อผิดพลาดในการปิดใช้งาน 2FA")}finally{x(!1)}},eh=async()=>{x(!0);try{let e=await fetch("/api/auth/logout-all",{method:"POST",headers:{Authorization:`Bearer ${localStorage.getItem("auth_token")}`}}),s=await e.json();s.success?(O.toast.success("ออกจากระบบทุกอุปกรณ์สำเร็จ"),V(!1),localStorage.removeItem("auth_token"),window.location.href="/"):O.toast.error(s.message)}catch(e){O.toast.error("เกิดข้อผิดพลาดในการออกจากระบบ")}finally{x(!1)}},em=async e=>{try{let s=await fetch("/api/auth/qr/scan",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({qrData:e})}),a=await s.json();a.success?(es(a.sessionId),el({sessionId:a.sessionId,twoFactorToken:""}),Z(!1),et(!0),O.toast.success("QR Code สแกนสำเร็จ")):O.toast.error(a.message||"QR Code ไม่ถูกต้องหรือหมดอายุ")}catch(e){console.error("QR scan error:",e),O.toast.error("เกิดข้อผิดพลาดในการสแกน QR Code")}},eu=async()=>{x(!0);try{let s={sessionId:er.sessionId};if(e?.twoFactorEnabled){if(!er.twoFactorToken)return void O.toast.error("กรุณาป้อนรหัส 2FA");s.twoFactorToken=er.twoFactorToken}let a=await fetch("/api/auth/qr/verify",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify(s)}),t=await a.json();t.success?(O.toast.success("เข้าสู่ระบบสำเร็จ! อุปกรณ์อื่นได้เข้าสู่ระบบแล้ว"),et(!1),el({sessionId:"",twoFactorToken:""})):O.toast.error(t.message||"การยืนยันล้มเหลว")}catch(e){console.error("QR verify error:",e),O.toast.error("เกิดข้อผิดพลาดในการยืนยัน")}finally{x(!1)}};return(0,s.jsx)(q.default,{children:(0,s.jsxs)("main",{className:"min-h-screen",children:[(0,s.jsx)("div",{className:"flex justify-center border-b",children:(0,s.jsxs)("div",{className:"w-full max-w-5xl border-x p-3",children:[(0,s.jsx)("h1",{className:"text-lg font-medium",children:"ความปลอดภัยของบัญชี"}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs",children:"จัดการการตั้งค่าความปลอดภัยและข้อมูลส่วนตัวของคุณ"})]})}),(0,s.jsx)("div",{className:"flex justify-center border-b",children:(0,s.jsxs)("div",{className:"w-full max-w-5xl border-x p-3 space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"flex items-center gap-2 text-base font-medium",children:[(0,s.jsx)(y.Shield,{className:"h-5 w-5"}),"สถานะความปลอดภัย"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"ตรวจสอบระดับความปลอดภัยของบัญชีของคุณ"})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-3",children:[(0,s.jsx)("div",{className:"flex items-center gap-3 p-3 border rounded-md",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-sm",children:"รหัสผ่าน"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"ตั้งค่าแล้ว"})]})}),(0,s.jsx)("div",{className:`flex items-center gap-3 p-3 border rounded-md ${e?.twoFactorEnabled?"":"opacity-50 select-none relative"}`,children:e?.twoFactorEnabled?(0,s.jsx)(s.Fragment,{children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-sm",children:"การยืนยันตัวตน 2 ชั้น"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"เปิดใช้งานแล้ว"})]})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(o,{className:"opacity-50"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)("p",{className:"font-medium text-sm",children:"การยืนยันตัวตน 2 ชั้น"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"ยังไม่ได้ตั้งค่า"})]})]})}),(0,s.jsx)("div",{className:"flex items-center gap-3 p-3 border rounded-md",children:(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-sm",children:"อีเมล"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"ยืนยันแล้ว"})]})})]})})]})}),(0,s.jsx)("div",{className:"flex justify-center border-b",children:(0,s.jsx)("div",{className:"w-full max-w-5xl border-x p-3 space-y-3",children:(0,s.jsxs)(f.Tabs,{defaultValue:"tab-1",children:[(0,s.jsxs)(v.ScrollArea,{children:[(0,s.jsxs)(f.TabsList,{className:"mb-3 w-full",children:[(0,s.jsxs)(f.TabsTrigger,{value:"tab-1",children:[(0,s.jsx)(h,{"aria-hidden":"true",className:"-ms-0.5 me-1.5 opacity-60",size:16}),"เปลี่ยนรหัสผ่าน"]}),(0,s.jsxs)(f.TabsTrigger,{className:"group",value:"tab-2",children:[(0,s.jsx)(p.UserIcon,{"aria-hidden":"true",className:"-ms-0.5 me-1.5 opacity-60",size:16}),"ข้อมูลบัญชี",(0,s.jsx)(g.Badge,{className:"ms-1.5 min-w-5 bg-primary/15 px-1 transition-opacity group-data-[state=inactive]:opacity-50",variant:"secondary",children:"3"})]}),(0,s.jsxs)(f.TabsTrigger,{className:"group",value:"tab-3",children:[(0,s.jsx)(N.Smartphone,{"aria-hidden":"true",className:"-ms-0.5 me-1.5 opacity-60",size:16}),"2FA",e?.twoFactorEnabled&&(0,s.jsx)(g.Badge,{variant:"secondary",children:"เปิดใช้งานแล้ว"})]}),(0,s.jsxs)(f.TabsTrigger,{className:"group",value:"tab-5",children:[(0,s.jsx)(B,{"aria-hidden":"true",className:"-ms-0.5 me-1.5 opacity-60",size:16}),"QR เข้าสู่ระบบ",(0,s.jsx)(g.Badge,{className:"ms-1.5 transition-opacity group-data-[state=inactive]:opacity-50",children:"New"})]}),(0,s.jsxs)(f.TabsTrigger,{className:"group",value:"tab-4",children:[(0,s.jsx)(m.default,{"aria-hidden":"true",className:"-ms-0.5 me-1.5 opacity-60",size:16}),"การจัดการเซสชัน",(0,s.jsx)(g.Badge,{className:"ms-1.5 transition-opacity group-data-[state=inactive]:opacity-50",children:"New"})]})]}),(0,s.jsx)(v.ScrollBar,{orientation:"horizontal"})]}),(0,s.jsx)(f.TabsContent,{value:"tab-1",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"flex items-center gap-2 text-base font-medium",children:[(0,s.jsx)(h,{className:"h-5 w-5"}),"เปลี่ยนรหัสผ่าน"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"เปลี่ยนรหัสผ่านเพื่อเพิ่มความปลอดภัยให้กับบัญชีของคุณ"})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("form",{onSubmit:en,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{className:"font-normal",htmlFor:"current-password",children:"รหัสผ่านปัจจุบัน"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(r.Input,{id:"current-password",type:P?"text":"password",placeholder:"กรุณาป้อนรหัสผ่านปัจจุบัน",value:ei.currentPassword,onChange:e=>ec({...ei,currentPassword:e.target.value}),required:!0}),(0,s.jsx)(t.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>M(!P),children:P?(0,s.jsx)(S.EyeOff,{className:"h-4 w-4"}):(0,s.jsx)(C.Eye,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{className:"font-normal",htmlFor:"new-password",children:"รหัสผ่านใหม่"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(r.Input,{id:"new-password",type:L?"text":"password",placeholder:"กรุณาป้อนรหัสผ่านใหม่",value:ei.newPassword,onChange:e=>ec({...ei,newPassword:e.target.value}),required:!0}),(0,s.jsx)(t.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>U(!L),children:L?(0,s.jsx)(S.EyeOff,{className:"h-4 w-4"}):(0,s.jsx)(C.Eye,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{className:"font-normal",htmlFor:"confirm-password",children:"ยืนยันรหัสผ่านใหม่"}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(r.Input,{id:"confirm-password",type:_?"text":"password",placeholder:"กรุณายืนยันรหัสผ่านใหม่",value:ei.confirmPassword,onChange:e=>ec({...ei,confirmPassword:e.target.value}),required:!0}),(0,s.jsx)(t.Button,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>Q(!_),children:_?(0,s.jsx)(S.EyeOff,{className:"h-4 w-4"}):(0,s.jsx)(C.Eye,{className:"h-4 w-4"})})]})]}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsxs)(t.Button,{className:"w-full cursor-pointer",type:"submit",disabled:n,children:[(0,s.jsx)(T.Save,{className:"h-4 w-4"}),n?"กำลังเปลี่ยน...":"เปลี่ยนรหัสผ่าน"]})})]})})]})}),(0,s.jsx)(f.TabsContent,{value:"tab-2",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"flex items-center gap-2 text-base font-medium",children:[(0,s.jsx)(F.User,{className:"h-5 w-5"}),"ข้อมูลบัญชี"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"ข้อมูลพื้นฐานของบัญชีของคุณ"})]}),(0,s.jsx)("div",{children:(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-md border p-2 flex items-start gap-2",children:[(0,s.jsx)("div",{className:"bg-zinc-100 p-2 rounded-md text-zinc-800 ",children:(0,s.jsx)(p.UserIcon,{className:"w-6 h-6"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.Label,{className:"text-xs font-medium text-gray-500",children:"ชื่อผู้ใช้งาน"}),(0,s.jsx)("p",{className:"text-sm text-black",children:e?.username})]})]}),(0,s.jsxs)("div",{className:"rounded-md border p-2 flex items-start gap-2",children:[(0,s.jsx)("div",{className:"bg-zinc-100 p-2 rounded-md text-zinc-800 ",children:(0,s.jsx)(u.MailIcon,{className:"w-6 h-6"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.Label,{className:"text-xs font-medium text-gray-500",children:"อีเมล"}),(0,s.jsx)("p",{className:"text-sm text-black",children:e?.email})]})]}),(0,s.jsxs)("div",{className:"rounded-md border p-2 flex items-start gap-2",children:[(0,s.jsx)("div",{className:"bg-zinc-100 p-2 rounded-md text-zinc-800 ",children:(0,s.jsx)(j.ShieldCheckIcon,{className:"w-6 h-6"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.Label,{className:"text-xs font-medium text-gray-500",children:"ระดับผู้ใช้"}),(0,s.jsx)(g.Badge,{variant:e?.role===1?"default":"secondary",className:"text-sm text-black",children:e?.role===1?"ผู้ดูแลระบบ":"ผู้ใช้ทั่วไป"})]})]}),(0,s.jsxs)("div",{className:"rounded-md border p-2 flex items-start gap-2",children:[(0,s.jsx)("div",{className:"bg-zinc-100 p-2 rounded-md text-zinc-800 ",children:(0,s.jsx)(d.CalendarIcon,{className:"w-6 h-6"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)(l.Label,{className:"text-xs font-medium text-gray-500",children:"วันที่สร้างบัญชี"}),(0,s.jsx)("p",{className:"text-sm text-black",children:e?.time?new Date(e.time).toLocaleDateString("th-TH"):"ไม่ระบุ"})]})]})]})})]})}),(0,s.jsx)(f.TabsContent,{value:"tab-3",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"flex items-center gap-2 text-base font-medium",children:[(0,s.jsx)(N.Smartphone,{className:"h-5 w-5"}),"การยืนยันตัวตน 2 ชั้น (2FA)"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"เพิ่มความปลอดภัยให้กับบัญชีของคุณด้วย Google Authenticator"})]}),(0,s.jsx)("div",{children:e?.twoFactorEnabled?(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)(i.Alert,{children:[(0,s.jsx)(b.CheckCircle,{className:"h-4 w-4"}),(0,s.jsx)(i.AlertDescription,{children:"การยืนยันตัวตน 2 ชั้นเปิดใช้งานแล้ว"})]}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsxs)(t.Button,{className:"w-full cursor-pointer",variant:"destructive",onClick:()=>W(!0),disabled:n,children:[(0,s.jsx)(k.XCircle,{className:"h-4 w-4"}),"ปิดใช้งาน 2FA"]})})]}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)(i.Alert,{children:[(0,s.jsx)(w.AlertTriangle,{className:"h-4 w-4"}),(0,s.jsx)(i.AlertDescription,{children:"การยืนยันตัวตน 2 ชั้นยังไม่ได้เปิดใช้งาน"})]}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsxs)(t.Button,{className:"w-full cursor-pointer",onClick:eo,disabled:n,children:[(0,s.jsx)(D.QrCode,{className:"h-4 w-4"}),"เปิดใช้งาน 2FA"]})})]})})]})}),(0,s.jsx)(f.TabsContent,{value:"tab-4",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"flex items-center gap-2 text-base font-medium",children:[(0,s.jsx)(N.Smartphone,{className:"h-5 w-5"}),"การจัดการเซสชัน"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"จัดการอุปกรณ์ที่เข้าสู่ระบบด้วยบัญชีนี้"})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)(i.Alert,{children:[(0,s.jsx)(w.AlertTriangle,{className:"h-4 w-4"}),(0,s.jsx)(i.AlertDescription,{children:"การออกจากระบบทุกอุปกรณ์จะทำให้คุณต้องเข้าสู่ระบบใหม่ในทุกที่"})]}),(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsxs)(t.Button,{variant:"destructive",className:"w-full cursor-pointer",onClick:()=>V(!0),disabled:n,children:[(0,s.jsx)(A,{className:"h-4 w-4"}),"ออกจากระบบทุกอุปกรณ์"]})})]})]})}),(0,s.jsx)(f.TabsContent,{value:"tab-5",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h2",{className:"flex items-center gap-2 text-base font-medium",children:[(0,s.jsx)(B,{className:"h-5 w-5"}),"QR เข้าสู่ระบบ"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"สแกน QR Code เพื่ออนุญาตให้อุปกรณ์อื่นเข้าสู่ระบบ"})]}),(0,s.jsx)("div",{children:Y?(0,s.jsx)(E,{onScanSuccess:em,onClose:()=>Z(!1)}):(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"text-center py-8 space-y-4",children:[(0,s.jsx)(I,{className:"w-16 h-16 mx-auto text-muted-foreground"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"พร้อมสแกน QR Code"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"เปิดกล้องเพื่อสแกน QR Code จากอุปกรณ์อื่น"})]})]}),(0,s.jsx)("div",{className:"flex gap-2",children:(0,s.jsxs)(t.Button,{className:"flex-1 cursor-pointer",onClick:()=>Z(!0),children:[(0,s.jsx)(B,{className:"w-4 h-4 mr-2"}),"เปิดสแกนเนอร์"]})})]})})]})})]})})}),(0,s.jsx)(c.Dialog,{open:G,onOpenChange:K,children:(0,s.jsxs)(c.DialogContent,{className:"max-w-md",children:[(0,s.jsxs)(c.DialogHeader,{children:[(0,s.jsx)(c.DialogTitle,{children:"เปิดใช้งาน 2FA"}),(0,s.jsx)(c.DialogDescription,{children:"สแกน QR Code นี้ด้วยแอพ Google Authenticator หรือแอพ 2FA อื่นๆ"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[$.qrCodeUrl&&(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)("img",{src:$.qrCodeUrl,alt:"2FA QR Code",className:"w-48 h-48"})}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{children:"Secret Key (สำรอง)"}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)(r.Input,{value:$.secret,readOnly:!0,className:"font-mono text-sm"}),(0,s.jsx)(t.Button,{type:"button",variant:"outline",size:"icon",onClick:()=>{navigator.clipboard.writeText($.secret),O.toast.success("คัดลอก Secret สำเร็จ")},children:(0,s.jsx)(z.Copy,{className:"h-4 w-4"})})]})]}),(0,s.jsxs)("form",{onSubmit:ed,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.Label,{children:"รหัส 6 หลักจากแอพ"}),(0,s.jsx)(r.Input,{type:"text",placeholder:"000000",value:$.token,onChange:e=>J({...$,token:e.target.value.replace(/\D/g,"").slice(0,6)}),maxLength:6,required:!0})]}),(0,s.jsxs)(c.DialogFooter,{children:[(0,s.jsx)(t.Button,{type:"button",variant:"outline",onClick:()=>{K(!1),J({secret:"",qrCodeUrl:"",otpauth_url:"",token:""})},disabled:n,children:"ยกเลิก"}),(0,s.jsx)(t.Button,{type:"submit",disabled:n||6!==$.token.length,children:n?"กำลังเปิดใช้งาน...":"เปิดใช้งาน 2FA"})]})]})]})]})}),(0,s.jsx)(c.Dialog,{open:X,onOpenChange:W,children:(0,s.jsxs)(c.DialogContent,{children:[(0,s.jsxs)(c.DialogHeader,{children:[(0,s.jsx)(c.DialogTitle,{children:"ปิดใช้งาน 2FA"}),(0,s.jsx)(c.DialogDescription,{children:"คุณต้องการปิดใช้งานการยืนยันตัวตน 2 ชั้นหรือไม่? การดำเนินการนี้จะทำให้บัญชีของคุณมีความเสี่ยงมากขึ้น"})]}),(0,s.jsxs)(c.DialogFooter,{children:[(0,s.jsx)(t.Button,{variant:"outline",onClick:()=>W(!1),disabled:n,children:"ยกเลิก"}),(0,s.jsx)(t.Button,{variant:"destructive",onClick:ex,disabled:n,children:n?"กำลังปิดใช้งาน...":"ปิดใช้งาน 2FA"})]})]})}),(0,s.jsx)(c.Dialog,{open:H,onOpenChange:V,children:(0,s.jsxs)(c.DialogContent,{children:[(0,s.jsxs)(c.DialogHeader,{children:[(0,s.jsx)(c.DialogTitle,{children:"ยืนยันการออกจากระบบ"}),(0,s.jsx)(c.DialogDescription,{children:"คุณต้องการออกจากระบบทุกอุปกรณ์หรือไม่? การดำเนินการนี้จะทำให้คุณต้องเข้าสู่ระบบใหม่ในทุกอุปกรณ์ที่ใช้งานบัญชีนี้"})]}),(0,s.jsxs)(c.DialogFooter,{children:[(0,s.jsx)(t.Button,{variant:"outline",onClick:()=>V(!1),disabled:n,children:"ยกเลิก"}),(0,s.jsx)(t.Button,{variant:"destructive",onClick:eh,disabled:n,children:n?"กำลังออกจากระบบ...":"ยืนยันการออกจากระบบ"})]})]})}),(0,s.jsx)(c.Dialog,{open:ea,onOpenChange:et,children:(0,s.jsxs)(c.DialogContent,{children:[(0,s.jsxs)(c.DialogHeader,{children:[(0,s.jsxs)(c.DialogTitle,{className:"flex items-center gap-2",children:[(0,s.jsx)(b.CheckCircle,{className:"w-5 h-5 text-green-500"}),"ยืนยันการเข้าสู่ระบบ"]}),(0,s.jsx)(c.DialogDescription,{children:"อุปกรณ์อื่นต้องการเข้าสู่ระบบด้วยบัญชีนี้"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("div",{className:"p-4 bg-blue-50 border rounded-lg",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)(I,{className:"w-8 h-8 text-blue-500"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium",children:"อุปกรณ์ใหม่"}),(0,s.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Chrome บน Windows • ",new Date().toLocaleTimeString("th-TH")]})]})]})}),e?.twoFactorEnabled&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)(l.Label,{className:"font-normal flex items-center gap-2",children:[(0,s.jsx)(y.Shield,{className:"w-4 h-4"}),"รหัส 2FA (6 หลัก)"]}),(0,s.jsx)("input",{type:"text",value:er.twoFactorToken,onChange:e=>el(s=>({...s,twoFactorToken:e.target.value.replace(/\D/g,"").slice(0,6)})),className:"w-full p-2 border rounded-md text-center text-lg font-mono",placeholder:"000000",maxLength:6}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"ป้อนรหัสจากแอพ Google Authenticator"})]}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground",children:[(0,s.jsx)("p",{children:"⚠️ ตรวจสอบให้แน่ใจว่าคุณรู้จักอุปกรณ์นี้"}),(0,s.jsx)("p",{children:"การยืนยันนี้จะอนุญาตให้อุปกรณ์เข้าถึงบัญชีของคุณ"})]})]}),(0,s.jsxs)(c.DialogFooter,{children:[(0,s.jsx)(t.Button,{variant:"outline",onClick:()=>{et(!1),el({sessionId:"",twoFactorToken:""})},disabled:n,children:"ยกเลิก"}),(0,s.jsx)(t.Button,{onClick:eu,disabled:n||e?.twoFactorEnabled&&6!==er.twoFactorToken.length,children:n?"กำลังยืนยัน...":"อนุญาตเข้าสู่ระบบ"})]})]})})]})})}e.s(["default",()=>L],43825)}]);