(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,76015,e=>{"use strict";var s=e.i(43476),t=e.i(32341),r=e.i(18566),a=e.i(71645),l=e.i(87968);function i({children:e}){let{isAuth:i,loading:n}=(0,t.useAuth)(),c=(0,r.useRouter)();return((0,a.useEffect)(()=>{n||i||c.push("/")},[i,n,c]),n)?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)(l.Spinner,{})}):i?(0,s.jsx)(s.Fragment,{children:e}):null}e.s(["default",()=>i])},60507,78894,e=>{"use strict";var s=e.i(46753);e.s(["UserIcon",()=>s.default],60507);var t=e.i(74296);e.s(["AlertTriangle",()=>t.default],78894)},29592,56909,e=>{"use strict";var s=e.i(43476),t=e.i(25913),r=e.i(75157);let a=(0,t.cva)("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function l({className:e,variant:t,...l}){return(0,s.jsx)("div",{"data-slot":"alert",role:"alert",className:(0,r.cn)(a({variant:t}),e),...l})}function i({className:e,...t}){return(0,s.jsx)("div",{"data-slot":"alert-description",className:(0,r.cn)("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}e.s(["Alert",()=>l,"AlertDescription",()=>i],29592);let n=(0,e.i(75254).default)("save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);e.s(["Save",()=>n],56909)},3492,e=>{"use strict";var s=e.i(43476),t=e.i(71645),r=e.i(32341),a=e.i(76015),l=e.i(19455),i=e.i(93479),n=e.i(10204),c=e.i(72436),d=e.i(29592),o=e.i(46696),m=e.i(60507);let x=(0,e.i(75254).default)("image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);var u=e.i(56909),h=e.i(78894);function f(){let{user:e,login:f}=(0,r.useAuth)(),[p,j]=(0,t.useState)(!1),[g,v]=(0,t.useState)({username:e?.username||"",profile:e?.profile||""}),N=async s=>{if(s.preventDefault(),!g.username.trim())return void o.toast.error("กรุณากรอกชื่อผู้ใช้งาน");if(g.username.length<3)return void o.toast.error("ชื่อผู้ใช้งานต้องมีอย่างน้อย 3 ตัวอักษร");if(g.username.length>30)return void o.toast.error("ชื่อผู้ใช้งานต้องไม่เกิน 30 ตัวอักษร");if(g.profile.trim())try{let e=new URL(g.profile.trim());if(!["http:","https:"].includes(e.protocol))return void o.toast.error("URL รูปโปรไฟล์ต้องเป็น HTTP หรือ HTTPS")}catch{o.toast.error("URL รูปโปรไฟล์ไม่ถูกต้อง");return}j(!0);try{let s=await fetch("/api/auth/update-profile",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${localStorage.getItem("auth_token")}`},body:JSON.stringify({username:g.username.trim(),profile:g.profile.trim()||null})}),t=await s.json();if(t.success){if(o.toast.success("อัปเดตข้อมูลส่วนตัวสำเร็จ"),e){let s={...e,...t.data.user},r=localStorage.getItem("auth_token");r&&await f(r,s)}}else o.toast.error(t.message)}catch(e){o.toast.error("เกิดข้อผิดพลาดในการอัปเดตข้อมูลส่วนตัว")}finally{j(!1)}},y=()=>g.username!==(e?.username||"")||g.profile!==(e?.profile||"");return(0,s.jsx)(a.default,{children:(0,s.jsxs)("main",{className:"min-h-screen",children:[(0,s.jsx)("div",{className:"flex justify-center border-b",children:(0,s.jsxs)("div",{className:"w-full max-w-5xl border-x p-3",children:[(0,s.jsx)("h1",{className:"text-lg font-medium",children:"การตั้งค่า"}),(0,s.jsx)("p",{className:"text-muted-foreground text-xs",children:"จัดการข้อมูลส่วนตัวและการตั้งค่าบัญชีของคุณ"})]})}),(0,s.jsx)("div",{className:"flex justify-center border-b",children:(0,s.jsxs)("div",{className:"w-full max-w-5xl border-x p-3 space-y-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h1",{className:"flex items-center gap-2 text-base font-medium",children:[(0,s.jsx)(m.UserIcon,{className:"h-5 w-5"}),"ข้อมูลส่วนตัว"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"แก้ไขข้อมูลส่วนตัวและรูปโปรไฟล์ของคุณ"})]}),(0,s.jsxs)("div",{className:"rounded-md border p-3",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"flex items-center gap-2 text-base font-medium",children:[(0,s.jsx)(m.UserIcon,{className:"h-4 w-4"}),"แก้ไขข้อมูลส่วนตัว"]}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"อัปเดตข้อมูลส่วนตัวของคุณ"})]}),(0,s.jsxs)("div",{className:"space-y-3 mt-3",children:[(0,s.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,s.jsxs)("div",{className:"rounded-md border p-3 flex items-start gap-3 bg-muted/50",children:[(0,s.jsx)("div",{className:"bg-zinc-100 p-2 rounded-md text-zinc-800",children:(0,s.jsx)(m.UserIcon,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(n.Label,{className:"text-xs font-medium text-gray-500",children:"ชื่อผู้ใช้งานปัจจุบัน"}),(0,s.jsx)("p",{className:"text-sm font-medium text-black",children:e?.username})]})]}),e?.profile&&(0,s.jsxs)("div",{className:"rounded-md border p-3 flex items-start gap-3 bg-muted/50",children:[(0,s.jsx)("div",{className:"bg-zinc-100 p-2 rounded-md text-zinc-800",children:(0,s.jsx)(x,{className:"w-4 h-4"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)(n.Label,{className:"text-xs font-medium text-gray-500",children:"รูปโปรไฟล์ปัจจุบัน"}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsx)("img",{src:e.profile,alt:"Current profile",className:"w-8 h-8 rounded-full object-cover border"}),(0,s.jsx)("span",{className:"text-xs text-muted-foreground truncate flex-1",children:e.profile})]})]})]})]}),(0,s.jsx)(c.Separator,{}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h3",{className:"text-sm font-medium",children:"แก้ไขข้อมูล"}),(0,s.jsxs)("form",{onSubmit:N,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{className:"font-normal",htmlFor:"username",children:"ชื่อผู้ใช้งาน *"}),(0,s.jsx)(i.Input,{id:"username",type:"text",placeholder:"กรุณากรอกชื่อผู้ใช้งาน",value:g.username,onChange:e=>v({...g,username:e.target.value}),required:!0,maxLength:30}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"3-30 ตัวอักษร"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{className:"font-normal",htmlFor:"profile",children:"รูปโปรไฟล์ (URL)"}),(0,s.jsx)(i.Input,{id:"profile",type:"url",placeholder:"https://example.com/avatar.jpg",value:g.profile,onChange:e=>v({...g,profile:e.target.value})}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"URL รูปภาพสำหรับโปรไฟล์ (ไม่บังคับ)"})]}),g.profile&&(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(n.Label,{className:"font-normal",children:"ตัวอย่างรูปโปรไฟล์"}),(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 border rounded-md",children:[(0,s.jsx)("img",{src:g.profile,alt:"Profile preview",className:"w-12 h-12 rounded-full object-cover border",onError:e=>{e.currentTarget.style.display="none"}}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm font-medium",children:"รูปโปรไฟล์"}),(0,s.jsx)("p",{className:"text-xs text-muted-foreground",children:"ตัวอย่างการแสดงผล"})]})]})]}),(0,s.jsx)(c.Separator,{}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)(l.Button,{className:"flex-1 cursor-pointer",type:"submit",disabled:p||!y(),children:[(0,s.jsx)(u.Save,{className:"h-4 w-4 mr-2"}),p?"กำลังบันทึก...":"บันทึกการเปลี่ยนแปลง"]}),y()&&(0,s.jsx)(l.Button,{type:"button",variant:"outline",className:"flex-1 cursor-pointer",onClick:()=>v({username:e?.username||"",profile:e?.profile||""}),disabled:p,children:"ยกเลิกการเปลี่ยนแปลง"})]})]})]})]})]}),y()&&(0,s.jsxs)(d.Alert,{children:[(0,s.jsx)(h.AlertTriangle,{className:"h-4 w-4"}),(0,s.jsx)(d.AlertDescription,{children:"คุณมีการเปลี่ยนแปลงที่ยังไม่ได้บันทึก กรุณากดบันทึกเพื่ออัปเดตข้อมูล"})]})]})})]})})}e.s(["default",()=>f],3492)}]);